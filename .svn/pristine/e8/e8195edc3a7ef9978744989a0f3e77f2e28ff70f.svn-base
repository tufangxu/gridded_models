import six.postgis_driver as driver
from datetime import date
import time


def main():

    t0 = time.time()

    climate_data_provider = "rtma"
    # climate_data_provider = "prism"

    # calculate the spring index through this date
    end_date = date(2014, 8, 14)
    # year = 2012
    start_date = 0
    plants = ['lilac', 'arnold_red', 'zabelli']
    phenophases = ['leaf', 'bloom']

    # using daily tmin/tmax
    # driver.Six.load_climate_data(end_date, climate_data_provider)
    # driver.Six.compute_index('lilac', 'leaf', start_date)
    # driver.Six.create_raster('lilac', 'leaf', end_date)
    # driver.Six.postgis_import('lilac', 'leaf', end_date, climate_data_provider)


    #   # using hourly temps
    driver.Six.load_hourly_climate_data(end_date, "rtma")
    driver.Six.compute_hourly_index('lilac', 'leaf', start_date)
    driver.Six.create_raster('lilac', 'leaf', end_date)
    # # driver.Six.postgis_import('lilac', 'leaf', end_date, "rtma")

    t1 = time.time()
    print('finished computing spring index:')
    print(t1-t0)

    driver.Six.conn.close()

if __name__ == "__main__":
    main()
