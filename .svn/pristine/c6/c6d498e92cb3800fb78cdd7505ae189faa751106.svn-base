import requests

# define your parameters
url = 'http://150.135.175.19:8080/geoserver/rest/workspaces/my_workspace/datastores/my_datastore/featuretypes'
headers = {'Content-Type': 'text/xml'}
auth = ('admin', 'geoserver')

# define your XML string that you want to send to the server
data = """
    <featureType>
    <name>my_layer_name</name>
    <srs>EPSG:4326</srs>
    <enabled>true</enabled>
    <metadata>
    <entry key="time">
    <dimensionInfo>
    <enabled>true</enabled>
    <attribute>datetime</attribute>
    <presentation>CONTINUOUS_INTERVAL</presentation>
    <units>ISO8601</units>
    <defaultValue><strategy>MAXIMUM</strategy></defaultValue>
    </dimensionInfo>
    </entry>
    </metadata>
    <store class="dataStore">
        <name>my_datastore</name>
    </store>
</featureType>
"""

# fire the request
r = requests.post(url, headers=headers, auth=auth, data=data)

# inspect the response
print(r.text)


def add_layer(workspace, datastore, layer_name, epsg):
    # define your parameters
    url = 'http://150.135.175.19:8080/geoserver/rest/workspaces/my_workspace/datastores/my_datastore/featuretypes'
    headers = {'Content-Type': 'text/xml'}
    auth = ('admin', 'geoserver')

    # define your XML string that you want to send to the server
    data = """
        <featureType>
        <name>my_layer_name</name>
        <srs>EPSG:4326</srs>
        <enabled>true</enabled>
        <metadata>
        <entry key="time">
        <dimensionInfo>
        <enabled>true</enabled>
        <attribute>datetime</attribute>
        <presentation>CONTINUOUS_INTERVAL</presentation>
        <units>ISO8601</units>
        <defaultValue><strategy>MAXIMUM</strategy></defaultValue>
        </dimensionInfo>
        </entry>
        </metadata>
        <store class="dataStore">
            <name>my_datastore</name>
        </store>
    </featureType>
    """

    # fire the request
    r = requests.put(url, headers=headers, auth=auth, data=data)

    # inspect the response
    print(r.text)
